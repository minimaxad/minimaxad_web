# Resend設定ガイド

## 概要
このプロジェクトでは、お問い合わせフォームと見積もり依頼フォームのメール送信に[Resend](https://resend.com)を使用しています。

## メール設定

### 現在の設定
- **送信者アドレス**: `contact@minimaxad.com`
- **受信者アドレス**: `info@minimaxad.com`

この設定により、以下の利点があります：
- 送信と受信の分離により、メールループを防止
- より良いメール配信率
- スパムフィルターでの誤検知を回避

## 設定手順

### 1. Resendアカウントの作成
1. [Resend](https://resend.com)にアクセス
2. アカウントを作成
3. APIキーを取得

### 2. 環境変数の設定
プロジェクトルートに`.env.local`ファイルを作成し、以下の内容を追加：

```env
# Resend API Configuration
RESEND_API_KEY=re_8V8HQSGs_LhUJBagZRv65MnMczFMmUaEp
```

**注意**: `.env.local`ファイルは`.gitignore`に含まれているため、Gitにコミットされません。

### 3. ドメインの設定
Resendでドメインを設定する必要があります：

1. Resendダッシュボードで「Domains」セクションに移動
2. ドメインを追加（例：`minimaxad.com`）
3. DNSレコードを設定（TXT、MX、SPFレコード）
4. ドメインの検証を完了

### 4. メールアドレスの設定
以下のメールアドレスをResendで設定してください：

- `contact@minimaxad.com` - 送信用アドレス
- `info@minimaxad.com` - 受信用アドレス

## APIエンドポイント

### お問い合わせフォーム
- **エンドポイント**: `/api/send-email`
- **メソッド**: POST
- **送信者**: `contact@minimaxad.com`
- **受信者**: `info@minimaxad.com`

### 見積もり依頼フォーム
- **エンドポイント**: `/api/send-quote`
- **メソッド**: POST
- **送信者**: `contact@minimaxad.com`
- **受信者**: `info@minimaxad.com`

## 開発環境でのテスト

### 1. 開発サーバーの起動
```bash
npm run dev
```

### 2. フォームのテスト
1. お問い合わせページ（`/contact`）にアクセス
2. フォームにテストデータを入力
3. 送信ボタンをクリック
4. コンソールでエラーログを確認

### 3. 環境変数の確認
```bash
# .env.localファイルの内容を確認
Get-Content .env.local
```

## トラブルシューティング

### よくある問題

1. **APIキーエラー**
   - `.env.local`ファイルが正しく作成されているか確認
   - APIキーが正しく設定されているか確認

2. **ドメインエラー**
   - Resendでドメインが正しく設定されているか確認
   - DNSレコードが正しく設定されているか確認

3. **送信失敗**
   - ブラウザのコンソールでエラーメッセージを確認
   - サーバーログで詳細なエラー情報を確認

4. **メールアドレス設定エラー**
   - `contact@minimaxad.com`と`info@minimaxad.com`がResendで正しく設定されているか確認
   - 両方のアドレスが同じドメインに属しているか確認

### ログの確認
```bash
# Next.js開発サーバーのログを確認
npm run dev
```

## 本番環境での設定

### Vercelでの設定
1. Vercelプロジェクトの設定画面に移動
2. 「Environment Variables」セクションで環境変数を設定
3. `RESEND_API_KEY`を追加

### その他のホスティングサービス
各ホスティングサービスの環境変数設定方法に従って、`RESEND_API_KEY`を設定してください。

## セキュリティ注意事項

1. **APIキーの保護**
   - APIキーをGitにコミットしない
   - 環境変数として安全に管理

2. **レート制限**
   - Resendのレート制限を確認
   - 必要に応じてスパム対策を実装

3. **入力検証**
   - フォーム入力の検証を実装
   - XSS攻撃対策

4. **メールアドレスの分離**
   - 送信者と受信者のアドレスを分離
   - メールループを防止

## メール設定の利点

### 送信者と受信者の分離
- **送信者**: `contact@minimaxad.com`
  - システムからの自動送信専用
  - 返信不要の通知メール
  
- **受信者**: `info@minimaxad.com`
  - ビジネス用のメインアドレス
  - 顧客からの返信を受け取る
  - チーム全体で共有可能

### 運用上の利点
1. **メール管理の効率化**
   - 自動送信と手動対応の分離
   - スパムフィルターでの誤検知回避

2. **顧客対応の改善**
   - 顧客が`info@minimaxad.com`に返信可能
   - 適切な担当者への転送が容易

3. **システムの安定性**
   - メールループの防止
   - 配信率の向上

## 参考リンク
